(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{315:function(v,_,t){v.exports=t.p+"assets/img/diffSummary1.c745894b.png"},389:function(v,_,t){"use strict";t.r(_);var e=t(14),a=Object(e.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"diff算法总结"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#diff算法总结"}},[v._v("#")]),v._v(" Diff算法总结")]),v._v(" "),_("p",[v._v("我们都知道 Vue 使用 "),_("code",[v._v("虚拟DOM")]),v._v("树 来描述"),_("code",[v._v("真实DOM")]),v._v("树，通过"),_("code",[v._v("Diff")]),v._v("算法对比新旧"),_("code",[v._v("虚拟DOM")]),v._v("树，对比差异，根据差异生成新的真实DOM树。")]),v._v(" "),_("p",[v._v("严格意义上来讲Diff两个DOM树的时间复杂度为"),_("code",[v._v("O(n^3)")]),v._v("，是无法用到实际场景中的。但Vue"),_("code",[v._v("Diff")]),v._v("算法优化后时间复杂度只有 "),_("code",[v._v("O(n)")]),v._v("。")]),v._v(" "),_("p",[v._v("本小节我们一起总结下，Vue"),_("code",[v._v("Diff")]),v._v("算法究竟干了什么，做了什么优化。")]),v._v(" "),_("h2",{attrs:{id:"深度优先"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#深度优先"}},[v._v("#")]),v._v(" 深度优先")]),v._v(" "),_("p",[v._v("在深度优先搜索中，算法首先比较当前层级的节点，然后递归地向下遍历子节点，直到遍历完整个节点树。这种策略使得算法能够尽早地发现并处理节点差异，从而减少不必要的比较和操作。")]),v._v(" "),_("ol",[_("li",[v._v("从根节点开始，依次比较新旧 VNode：\n"),_("ul",[_("li",[v._v("如果两个 VNode 不同，则执行相应的更新操作。")]),v._v(" "),_("li",[v._v("如果两个 VNode 相同，则进一步比较和更新子节点。")])])]),v._v(" "),_("li",[v._v("对于每个 VNode 的子节点列表，依次进行深度优先搜索：\n"),_("ul",[_("li",[v._v("对比新旧子节点列表的节点差异。")]),v._v(" "),_("li",[v._v("递归地对比和更新子节点的子节点，直到遍历完整个节点树。")])])])]),v._v(" "),_("h2",{attrs:{id:"只在同层级比较"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#只在同层级比较"}},[v._v("#")]),v._v(" 只在同层级比较")]),v._v(" "),_("p",[v._v("回顾我们之前分析的"),_("code",[v._v("Patch")]),v._v("方法，都是对比的同一层级，没有跨层级的逻辑。")]),v._v(" "),_("p",[_("img",{attrs:{src:t(315),alt:"同一层级对比"}})]),v._v(" "),_("p",[v._v("在同一层级对比过程中，遵循以下规则：")]),v._v(" "),_("ol",[_("li",[v._v("忽略静态节点")]),v._v(" "),_("li",[v._v("只针对相同节点（tag 和 key，两者都相同）对比，节点不相同直接删除重建")])]),v._v(" "),_("h2",{attrs:{id:"子节点更新策略"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#子节点更新策略"}},[v._v("#")]),v._v(" 子节点更新策略")]),v._v(" "),_("ol",[_("li",[v._v("采用双端比较循环，减少循环次数")]),v._v(" "),_("li",[v._v("选择了从子节点列表中的4个特殊位置互相比对，分别是：新前与旧前，新后与旧后，新后与旧前，新前与旧后。较少对比次数")]),v._v(" "),_("li",[v._v("特殊位置对比完后未处理的数据再递归判断。")])])])}),[],!1,null,null,null);_.default=a.exports}}]);