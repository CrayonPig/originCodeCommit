(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{286:function(t,a,s){t.exports=s.p+"assets/img/divStr.a052465d.png"},332:function(t,a,s){"use strict";s.r(a);var e=s(14),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),a("p",[t._v("虚拟DOM（Virtual DOM）是近年来在前端开发中崭露头角的概念，它在提升性能、优化渲染和改善用户体验方面发挥了重要的作用。本章将深入探索虚拟DOM的工作原理和背后的思想。我们将介绍虚拟DOM是如何在Vue中发挥作用的。")]),t._v(" "),a("h2",{attrs:{id:"什么是虚拟dom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是虚拟dom"}},[t._v("#")]),t._v(" 什么是虚拟DOM")]),t._v(" "),a("p",[t._v("虚拟DOM是一个"),a("code",[t._v("JavaScript对象")]),t._v("的表示，它是对"),a("code",[t._v("真实DOM")]),t._v("的轻量级抽象。如下示例：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"button"')]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"btn"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("这是一个按钮"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 元素标签")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("attrs")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 属性")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'button'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'btn'")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("text")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'这是一个按钮'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 文本内容")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("children")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 子元素")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")]),a("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[a("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1689342550737-85052"}},[t._v("成功")]),a("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"<div class=\"button\" id=\"btn\">这是一个按钮</div>\n\n{\n  tag:'div',        // 元素标签\n  attrs:{           // 属性\n    class:'button',\n    id:'btn'\n  },\n  text:'这是一个按钮',  // 文本内容\n  children:[]       // 子元素\n}\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1689342550737-85052","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("复制代码")])])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("p",[t._v("像这样，可以用一个"),a("code",[t._v("JavaScript对象")]),t._v("描述"),a("code",[t._v("真实DOM")]),t._v("节点的，我们称这个"),a("code",[t._v("JavaScript对象")]),t._v("是"),a("code",[t._v("真实DOM")]),t._v("节点的"),a("code",[t._v("虚拟DOM")]),t._v("节点")]),t._v(" "),a("h2",{attrs:{id:"为什么要用虚拟dom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为什么要用虚拟dom"}},[t._v("#")]),t._v(" 为什么要用虚拟DOM")]),t._v(" "),a("p",[t._v("我们知道，想要在视图中渲染，势必就要操作"),a("code",[t._v("真实DOM")]),t._v("，而操作"),a("code",[t._v("真实DOM")]),t._v("又是非常耗费性能的。因为在浏览器标准中，"),a("code",[t._v("真实DOM")]),t._v("就是一个非常复杂的结构。我们可以尝试用以下方式打印"),a("code",[t._v("真实DOM")]),t._v("来查看")]),t._v(" "),a("p",[a("img",{attrs:{src:s(286),alt:"空div打印"}})]),t._v(" "),a("p",[t._v("可以看到创建一个空div的"),a("code",[t._v("真实DOM")]),t._v("都十分的庞大，更何况我们在复杂的应用中需要操作大量的"),a("code",[t._v("真实DOM")]),t._v("，还有较为复杂的结构，这势必会对性能造成一定的影响。")]),t._v(" "),a("p",[t._v("所以如何尽量"),a("code",[t._v("真实DOM")]),t._v("的操作，成了框架设计中一个避不开的环节。在这个基础上，"),a("code",[t._v("虚拟DOM")]),t._v("应运而生。")]),t._v(" "),a("h2",{attrs:{id:"虚拟dom如何节省性能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚拟dom如何节省性能"}},[t._v("#")]),t._v(" 虚拟DOM如何节省性能")]),t._v(" "),a("p",[t._v('虚拟DOM通过在内存中构建一个轻量级的DOM树来解决这个问题。当应用程序的状态发生变化时，我们首先在虚拟DOM上进行修改，而不是直接操作真实DOM。通过比较新旧虚拟DOM的差异，我们可以确定哪些部分需要更新，并仅对这些部分进行实际的DOM操作。这种优化技术被称为"DOM Diffing"。')]),t._v(" "),a("p",[t._v("虚拟DOM的工作流程如下：")]),t._v(" "),a("ol",[a("li",[t._v("初始渲染：首次渲染时，将真实DOM转换为虚拟DOM。")]),t._v(" "),a("li",[t._v("状态变更：当应用程序的状态发生变化时，修改虚拟DOM树。")]),t._v(" "),a("li",[t._v("虚拟DOM Diffing：比较新旧虚拟DOM树的差异，找出需要更新的部分。")]),t._v(" "),a("li",[t._v("生成变更集：根据差异生成最小化的DOM操作序列。")]),t._v(" "),a("li",[t._v("应用变更：将变更应用于真实DOM，更新页面展示。")])]),t._v(" "),a("p",[t._v("通过使用虚拟DOM，我们可以减少真实DOM操作的次数，并最大程度地减少重绘和回流的成本。这种优化能够显著提升性能，特别是在大型复杂的应用程序中，或是需要频繁更新的动态内容中。")]),t._v(" "),a("h2",{attrs:{id:"虚拟dom比真实dom性能消耗更小么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚拟dom比真实dom性能消耗更小么"}},[t._v("#")]),t._v(" 虚拟DOM比真实DOM性能消耗更小么？")]),t._v(" "),a("p",[t._v("先说答案，"),a("strong",[t._v("是也不是")]),t._v("。")]),t._v(" "),a("p",[t._v("这是什么意思呢？")]),t._v(" "),a("p",[t._v("我们先假设一个场景，我需要用"),a("code",[t._v("原生JavaScript")]),t._v("更改div的内容，代码如下：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" div "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndiv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'changed'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")]),a("div",{pre:!0,attrs:{class:"m-mdic-copy-wrapper"}},[a("div",{pre:!0,attrs:{class:"u-mdic-copy-notify",id:"j-notify-1689342550737-79350"}},[t._v("成功")]),a("button",{pre:!0,attrs:{class:"u-mdic-copy-btn j-mdic-copy-btn","data-mdic-content":"const div = document.getElementById('div');\ndiv.textContent = 'changed';\n","data-mdic-attach-content":"","data-mdic-notify-id":"j-notify-1689342550737-79350","data-mdic-notify-delay":"2000","data-mdic-copy-fail-text":"copy fail",onclick:"!function(t){const e={copy:(t='',e='')=>new Promise((c,o)=>{const n=document.createElement('textarea'),d=e?`\\n\\n${e}`:e;n.value=`${t}${d}`,document.body.appendChild(n),n.select();try{const t=document.execCommand('copy');document.body.removeChild(n),t?c():o()}catch(t){document.body.removeChild(n),o()}}),btnClick(t){const c=t&&t.dataset?t.dataset:{},o=c.mdicNotifyId,n=document.getElementById(o),d=c.mdicNotifyDelay,i=c.mdicCopyFailText;e.copy(c.mdicContent,c.mdicAttachContent).then(()=>{n.style.display='block',setTimeout(()=>{n.style.display='none'},d)}).catch(()=>{alert(i)})}};e.btnClick(t)}(this);"}},[t._v("复制代码")])])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("现在思考下，还有没有比这个性能更好的替代方案？")]),t._v(" "),a("p",[t._v("很显然，并没有。可以看到，我们使用这种"),a("code",[t._v("命令式代码")]),t._v("可以做到极致的性能优化，因为我们知道哪里发生变化了，我们直接用命令去更新即可。")]),t._v(" "),a("p",[t._v("如果这个场景换成Vue这种"),a("code",[t._v("声明式代码")]),t._v("呢？会经历如下过程")]),t._v(" "),a("ol",[a("li",[t._v("首次渲染时，将真实DOM转换为虚拟DOM。")]),t._v(" "),a("li",[t._v("代表内容的变量字段发生变化，修改新的虚拟DOM树。")]),t._v(" "),a("li",[t._v("对比新旧虚拟DOM，找到差异。")]),t._v(" "),a("li",[t._v("根据差异更新给真实DOM树")])]),t._v(" "),a("p",[t._v("可以看到，在有"),a("code",[t._v("虚拟DOM")]),t._v("后，需要先去找到差异，再去更新"),a("code",[t._v("真实DOM")]),t._v("。这会比我们直接写"),a("code",[t._v("真实DOM")]),t._v("多一些性能消耗，所以这时候"),a("code",[t._v("虚拟DOM")]),t._v("并没有比"),a("code",[t._v("真实DOM")]),t._v("性能消耗更小。")]),t._v(" "),a("p",[t._v("有人会问了，那为什么还要使用"),a("code",[t._v("虚拟DOM")]),t._v("？")]),t._v(" "),a("p",[t._v("原因有两条:")]),t._v(" "),a("ol",[a("li",[t._v("在实际开发中，我们很难写出绝对优化的"),a("code",[t._v("命令式代码")])]),t._v(" "),a("li",[t._v("类似原生js或JQuery的"),a("code",[t._v("命令式代码")]),t._v("在开发中，我们需要手动完成"),a("code",[t._v("真实DOM")]),t._v("的创建、编辑、删除等工作，提升了开发过程中的心智负担。")])]),t._v(" "),a("p",[t._v("回到问题本身，"),a("code",[t._v("虚拟DOM")]),t._v("比"),a("code",[t._v("真实DOM")]),t._v("性能消耗更小么？")]),t._v(" "),a("p",[t._v("完整的答案应该是，在绝对优化代码的情况下，"),a("code",[t._v("虚拟DOM")]),t._v("比"),a("code",[t._v("真实DOM")]),t._v("性能消耗更大，因为要多一个找到差异的性能消耗。但在实际开发过程中，"),a("code",[t._v("虚拟DOM")]),t._v("比"),a("code",[t._v("真实DOM")]),t._v("性能消耗更小，因为我们写的代码无法做到绝对优化。")]),t._v(" "),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),a("p",[t._v('虚拟DOM是一个JavaScript对象的表示，它是对真实DOM的轻量级抽象。在传统的前端开发中，我们直接操作真实的DOM来进行页面的更新和渲染。每当我们修改DOM时，浏览器都需要重新计算样式、布局和绘制，这个过程被称为"重绘"（repaint）和"回流"（reflow），并且往往是昂贵且耗时的操作。')]),t._v(" "),a("p",[t._v('虚拟DOM通过在内存中构建一个轻量级的DOM树来解决这个问题。当应用程序的状态发生变化时，我们首先在虚拟DOM上进行修改，而不是直接操作真实DOM。通过比较新旧虚拟DOM的差异，我们可以确定哪些部分需要更新，并仅对这些部分进行实际的DOM操作。这种优化技术被称为"DOM Diffing"。')]),t._v(" "),a("p",[t._v("虚拟DOM的工作流程如下：")]),t._v(" "),a("ol",[a("li",[t._v("初始渲染：首次渲染时，将真实DOM转换为虚拟DOM。")]),t._v(" "),a("li",[t._v("状态变更：当应用程序的状态发生变化时，修改虚拟DOM树。")]),t._v(" "),a("li",[t._v("虚拟DOM Diffing：比较新旧虚拟DOM树的差异，找出需要更新的部分。")]),t._v(" "),a("li",[t._v("生成变更集：根据差异生成最小化的DOM操作序列。")]),t._v(" "),a("li",[t._v("应用变更：将变更应用于真实DOM，更新页面展示。")])]),t._v(" "),a("p",[t._v("通过使用虚拟DOM，我们可以减少真实DOM操作的次数，并最大程度地减少重绘和回流的成本。这种优化能够显著提升性能，特别是在大型复杂的应用程序中，或是需要频繁更新的动态内容中。")])])}),[],!1,null,null,null);a.default=n.exports}}]);